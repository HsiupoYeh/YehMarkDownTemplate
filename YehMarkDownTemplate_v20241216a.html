<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- 引入 Bootstrap 的 CSS 樣式 (包含了版面設計、按鈕樣式等) -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.3/css/bootstrap.min.css">
  <!-- 引入 GitHub Markdown 樣式 (讓 Markdown 內容的顯示風格更接近 GitHub) -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/5.8.1/github-markdown.min.css">
  <!-- 引入高亮程式碼樣式 (使用 highlight.js 為程式碼區塊提供 GitHub 風格的高亮顯示) -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.0/styles/github.min.css">
  <!-- 引入 Font Awesome 的圖示庫 (可用來顯示各種圖示，如社交媒體圖示、UI 元素等) -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.1/css/all.min.css">
  <!-- 引入 Markdown 渲染的 JavaScript 庫 (用來將 Markdown 格式的文本轉換為 HTML) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/markdown-it/13.0.2/markdown-it.min.js"></script>
  <!-- 引入 highlight.js 庫 (提供語法高亮的功能，支持多種編程語言的程式碼高亮) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.0/highlight.min.js"></script>
  <!-- 引入 Bootstrap 的 JavaScript (包含了 Popper.js 和其他 Bootstrap 的交互功能，如下拉選單、彈出框等) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.3/js/bootstrap.bundle.min.js"></script>
  <!-- 引入 Clipboard.js (提供複製程式碼的功能) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.10/clipboard.min.js"></script>
  
  <!-- 自定義樣式 -->
  <style>
    /* 標籤頁下方的內容區塊 */
    .tab-pane {
      margin-bottom: 20px;
      border-bottom-left-radius: 8px;  /* 圓角 */
      border-bottom-right-radius: 8px; /* 圓角 */
      border: 1px solid #ddd; /* 外框 */
    }

    /* 通用的內容外層邊距 */
    .content-wrapper {
      padding: 20px; /* 渲染區域的外邊距 */
    }

    /* 程式碼區塊的樣式 */
    pre {
      background-color: #f5f5f5; /* 程式碼區塊的背景色 */
      border-radius: 8px; /* 圓角效果 */
      padding: 15px; /* 程式碼區塊的內邊距 */
      margin-top: 10px; /* 程式碼區塊和其他內容之間的間距 */
    }

    /* 自定義按鈕懸停效果 */
    .btn-outline-primary:hover {
      background-color: #007bff; /* 按鈕懸停顏色 */
      color: white;
    }

    .code-block {
      position: relative;
    }

    .code-block button {
      position: absolute;
      top: 5px;
      right: 5px;
      z-index: 10;
    }

    /* 修正按鈕內文字垂直居中 */
    .btn {
      line-height: 1.5rem; /* 確保按鈕內的文字垂直居中 */
    }
  </style>
</head>
<body>
  <div class="container mt-5">
    <!-- Tab Navigation: 用來在頁面中切換不同的內容 -->
    <ul class="nav nav-tabs" id="myTab" role="tablist">
      <li class="nav-item" role="presentation">
        <button class="nav-link active" id="chapter-tab" data-bs-toggle="tab" data-bs-target="#chapter" type="button" role="tab" aria-controls="chapter" aria-selected="true">章節內容</button>
      </li>
      <li class="nav-item" role="presentation">
        <button class="nav-link" id="source-tab" data-bs-toggle="tab" data-bs-target="#source" type="button" role="tab" aria-controls="source" aria-selected="false">原始碼</button>
      </li>
      <li class="nav-item" role="presentation">
        <button class="nav-link" id="about-tab" data-bs-toggle="tab" data-bs-target="#about" type="button" role="tab" aria-controls="about" aria-selected="false">關於我</button>
      </li>
    </ul>

    <!-- Tab Content: 顯示對應的內容區塊 -->
    <div class="tab-content" id="myTabContent">
      <!-- 章節內容 -->
      <div class="tab-pane fade show active" id="chapter" role="tabpanel" aria-labelledby="chapter-tab">
        <div class="content-wrapper">
          <div class="markdown-body"></div>
        </div>
      </div>

      <!-- 原始碼 -->
      <div class="tab-pane fade" id="source" role="tabpanel" aria-labelledby="source-tab">
        <div class="content-wrapper">
          <div class="code-block">
            <!-- 添加複製程式碼按鈕 -->
            <button class="btn btn-sm btn-outline-primary" id="copy-source-btn" data-clipboard-target="#markdown-source">複製程式碼</button>
            <textarea id ="markdown-source" class="form-control" style="resize: none;" spellcheck="false" readonly></textarea>
          </div>
        </div>
      </div>

      <!-- 關於我 -->
      <div class="tab-pane fade" id="about" role="tabpanel" aria-labelledby="about-tab">
        <div class="content-wrapper">
          <!-- 軟體名稱 -->
          <div class="card shadow-sm mb-4">
            <div class="card-header">
              <h5 class="card-title mb-0">軟體名稱</h5>
            </div>
            <div class="card-body">
              <h4 class="card-title mb-2"><strong class="text-success">YehMarkDownTemplate_v20241216a</strong></h4>
              <ul>
                <li>用來撰寫說明文件、文章、數學公式等。</li>
                <li>響應式設計適合手機平板使用。</li>
                <li>可內嵌到Google協作平台使用</li>
              </ul>
            </div>
          </div>
          <!-- 作者資訊 -->
          <div class="card shadow-sm mb-4">
            <div class="card-header">
              <h5 class="card-title mb-0">作者資訊</h5>
            </div>
            <div class="card-body">
              <div class="d-flex flex-column flex-sm-row align-items-center">
                <!-- 圓形照片 -->
                <div class="col-auto mb-3 mb-md-0">
                  <img src="https://via.placeholder.com/100" alt="Logo" class="rounded-circle img-fluid">
                </div>
                <!-- 文字區塊 -->
                <div class="ms-3 text-center text-sm-start">
                  <!-- 姓名，置中顯示 -->
                  <div class="d-flex justify-content-center">
                    <h4 class="card-title mb-3"><strong>HsiupoYeh</strong></h4>
                  </div>
                  <!-- 使用 badge 顯示職稱，並置中 -->
                  <div class="d-flex justify-content-center justify-content-sm-start">
                    <span class="badge bg-secondary me-2 mb-2 mb-sm-0">地球物理學家</span>
                    <span class="badge bg-secondary me-2 mb-2 mb-sm-0">資深軟體工程師</span>
                  </div>
                </div>
              </div>
            </div>
            <div class="card-body">
              <!-- 其他資訊區塊 -->
              <div class="text-md-start text-center">
                <!-- 來自 Taiwan -->
                <div class="mb-2 d-flex align-items-center">
                  <div class="d-flex justify-content-center align-items-center" style="width: 30px;">
                    <i class="fas fa-map-marker-alt" title="來自"></i>
                  </div>
                  <span>Taiwan</span>
                </div>
                <!-- 個人網頁 -->
                <div class="mb-2 d-flex align-items-center">
                  <div class="d-flex justify-content-center align-items-center" style="width: 30px;">
                    <i class="fas fa-link me-2" title="個人網頁"></i>
                  </div>
                  <a href="https://hsiupoyeh.github.io/" target="_blank">https://hsiupoyeh.github.io/</a>
                </div>
                <!-- GitHub -->
                <div class="mb-2 d-flex align-items-center">
                  <div class="d-flex justify-content-center align-items-center" style="width: 30px;">
                    <i class="fab fa-github me-2" title="GitHub"></i>
                  </div>
                  <a href="https://github.com/HsiupoYeh" target="_blank">https://github.com/HsiupoYeh</a>
                </div>
              </div>
            </div>
          </div>
          <!-- 單一卡片展示所有更新紀錄 -->
          <div class="card shadow-sm mb-4">
            <div class="card-header">
              <h5 class="card-title mb-0">更新紀錄</h5>
            </div>
            <div class="card-body">
              <!-- 版本更新 -->
              <div class="mb-4">			  
                <h6 class="card-subtitle mb-2"><strong>2024-12-16</strong></h6>
                <ul>
                  <li class="text-dark">v20241216a</li>
				  <li class="text-secondary">改用Bootstrap5.3.3。</li>
				  <li class="text-secondary">新使用FontAwesome6.7.1。</li>
				  <li class="text-secondary">已知問題：當使用程式碼區塊時，渲染內容中若也恰好有「```」會造成渲染異常，因此請先將渲染中的內容用其他內容取代，建議「\```」。</li>
                </ul>
              </div>
              <!-- 分隔線 -->
              <hr>			  
              <!-- 版本更新 -->
              <div class="mb-4">			  
                <h6 class="card-subtitle mb-2"><strong>2024-12-15</strong></h6>
                <ul>
                  <li class="text-dark">v20241215a</li>
				  <li class="text-secondary">初版。</li>
				  <li class="text-secondary">使用Bootstrap4、markdown-it、highlight等函式庫。</li>
                </ul>
              </div>              
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

<!-- 存放Markdown原始碼 -->
<textarea id="markdown-editor" class="d-none">
# YehMarkDownTemplate v20241216a
+ YEH自製MarkDown模板，方便撰寫文件。

## 使用方法
+ 複製下方HTML原始碼，編輯id為「markdown-editor」的textarea內容，再另存為HTML檔案。
+ 注意程式碼區塊是由兩個「\```」包圍，若內部也有「\```」會造成渲染錯誤。有時可用「\\```」使其正常顯示，複製後可視需求修改。

### Javascript原始碼
```javascript
function greet() {
    console.log("Hello, world!");
}
greet();
```  

### Markdown原始碼
```md
### 怕錯誤的時候多加「\」
\```javascript
function greet() {
    console.log("Hello, world!");
}
greet();
\```
```  
</textarea>

<script>
  // 初始化 highlight.js
  hljs.highlightAll();

  // 初始化 markdown-it 並啟用程式碼高亮
  const md = window.markdownit({
    highlight: function (str, lang) {
      if (lang && hljs.getLanguage(lang)) {
        try {
          return hljs.highlight(str, { language: lang }).value;
        } catch (__) {}
      }
      return ''; // 預設高亮處理
    }
  });

  // 取得 Markdown 原始碼
  const markdownContent = document.getElementById('markdown-editor').value;
  const markdownContentLines = markdownContent.split('\n');  // 以換行符分割成行
  const markdownContentLinesCount = markdownContentLines.length;  // 計算行數

  // 渲染 Markdown 並顯示在第一個標籤頁 (章節內容)
  const chapterDiv = document.querySelector('#chapter .markdown-body');
  chapterDiv.innerHTML = md.render(markdownContent);

  // 在第二個標籤頁顯示 Markdown 原始碼 (原始碼)
  const markdownSource = document.getElementById('markdown-source');
  markdownSource.textContent = markdownContent;
  markdownSource.rows = markdownContentLinesCount;  // 設置行數

  // 創建複製按鈕並綁定 ID
  const codeBlocks = document.querySelectorAll('pre code');
  codeBlocks.forEach(function(codeBlock, index) {
    const codeBlockId = `code-${index + 1}`;
    codeBlock.setAttribute('id', codeBlockId);

    const copyButton = document.createElement('button');
    copyButton.innerText = '複製程式碼';
    copyButton.classList.add('btn', 'btn-sm', 'btn-outline-primary');
    copyButton.setAttribute('data-clipboard-target', `#${codeBlockId}`); // 綁定按鈕到對應的程式碼區塊

    // 把複製按鈕加到程式碼區塊中
    const codeBlockParent = codeBlock.parentElement;
    codeBlockParent.classList.add('code-block');
    codeBlockParent.appendChild(copyButton);
  });

  // 使用 Clipboard.js 來處理複製功能
  const clipboard = new ClipboardJS('.btn-outline-primary');
  clipboard.on('success', function(e) {
    const copyButton = e.trigger;
    copyButton.innerText = '已複製！';
    setTimeout(function() {
      copyButton.innerText = '複製程式碼';
    }, 1500);
    e.clearSelection();
  });

  clipboard.on('error', function(e) {
    const copyButton = e.trigger;
    copyButton.innerText = '複製失敗！';
    setTimeout(function() {
      copyButton.innerText = '複製程式碼';
    }, 1500);
    e.clearSelection();	
  });

  // 使用 Clipboard.js 來處理原始碼複製功能
  const clipboard2 = new ClipboardJS('#copy-source-btn');
  clipboard2.on('success', function(e) {
    const copyButton = e.trigger;
    copyButton.innerText = '已複製！';
    setTimeout(function() {
      copyButton.innerText = '複製程式碼';
    }, 1500);
    e.clearSelection();
  });

  clipboard2.on('error', function(e) {
    const copyButton = e.trigger;
    copyButton.innerText = '複製失敗！';
    setTimeout(function() {
      copyButton.innerText = '複製程式碼';
    }, 1500);
    e.clearSelection();	
  });
</script>
</body>
</html>
